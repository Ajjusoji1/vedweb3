<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel</title>
  <link rel="stylesheet" href="style.css" />
  


 

  <style>
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 2rem;
    }
    th, td {
      border: 1px solid #555;
      padding: 8px;
      text-align: left;
    }
    th {
      background: #222;
      color: #00ffff;
    }
    td {
      background: #111;
      color: #fff;
    }
    button {
      padding: 5px 10px;
      cursor: pointer;
      background: #00aaff;
      border: none;
      color: #fff;
      border-radius: 4px;
    }
    button:hover {
      background: #0088cc;
    }
    .reward-summary {
      background: #222;
      color: #fff;
      padding: 1rem;
      border-radius: 8px;
      margin-top: 2rem;
    }
    .reward-summary p {
      margin: 0.5rem 0;
    }
    h2, h3 {
      color: #00ffff;
    }
    body {
      background: #000;
      color: #fff;
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    h2 {
      border-bottom: 2px solid #00ffff;
      padding-bottom: 10px;
    }
    h3 {
      margin-top: 1.5rem;
      color: #00ffff;
    }
    .nav-btn {
      display: inline-block;
      margin: 0 10px;
      padding: 10px 20px;
      background: #00aaff;
      color: #fff;
      text-decoration: none;
      border-radius: 4px;
    }
    .nav-btn:hover {
      background: #0088cc;
    }
    .admin-card {
      background: #141a29;
    border: 1px solid #2a2f4a;
    border-radius: 16px;
    padding: 20px;
    margin: 20px auto;
    width: 90%;
    max-width: auto;
    box-shadow: 0 0 10px rgba(0, 255, 255, 0.1);
    color: #fff;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-size: 0.9rem;
    }
    .admin-card h3 {
      color: #00ffff;
    }
    .admin-card input {
      padding: 5px;
      width: 80%;
      margin-right: 10px;
      border: 1px solid #555;
      border-radius: 4px;
    }
    .admin-card button {
      padding: 5px 10px;
      background: #00aaff;
      border: none;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
    }
    .admin-card button:hover {
      background: #0088cc;
    }

  </style>
</head>

<body>
  <h2>üî• Admin Panel</h2>

  <div id="nav-buttons" style="text-align: center; margin-top: 10px;">
    <a href="index.html" class="nav-btn">üè† Home</a>
    <a href="stake.html" class="nav-btn">üì• Stake</a>
    <a href="history.html" class="nav-btn">üìú History</a>
    <a href="stake-analytics.html" class="nav-btn">üìä Analytics</a>
    <a href="admin.html" class="nav-btn">üîß Admin</a>
  </div>



  
 
  
 

 <!-- üî• Reward Summary Card -->

 <div class="reward-summary" style="margin-top: 20px; font-size: large; font-style: oblique;">
    <h2>üèÜ Rewards Overview</h2> 
    <p>Stake Rewards (Total): <span id="totalStakeReward">‚è≥</span></p> 
    <p>Stake Rewards (Claimed): <span id="claimedStakeReward">‚è≥</span></p>
     <p>Stake Rewards (Pending): <span id="pendingStakeReward">‚è≥</span></p> 
     <p>Referral Rewards (Total): <span id="totalReferralReward">‚è≥</span></p> 
    <p>Referral Rewards (Claimed): <span id="claimedReferralReward">‚è≥</span></p>
    <p>Referral Rewards (Pending): <span id="pendingReferralReward">‚è≥</span></p>

   <!-- ‚úÖUpdated with TRX Withdraw Summary & Custom Admin Tools -->

  <h3>üí∏ TRX Withdraw Summary</h3>
  <ul id="trxWithdrawSummary">
    <li>Total TRX Withdrawn: <b id="totalWithdraw">-</b> TRX</li>
    <li>From Stake Rewards: <b id="stakeWithdraw">-</b> TRX</li>
    <li>From Referral Rewards: <b id="referralWithdraw">-</b> TRX</li>  
  </ul>
</div>





<div class="admin-card">
  <h3>üßæ Pending Sales</h3>
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Type</th>
        <th>Wallet</th>
        <th>Amount</th>
        <th>TRX</th>
        <th>Status</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="salesTableBody">
      <!-- Sales go here -->
    </tbody>
  </table>
  <p>Click "‚úîÔ∏è Complete" to mark a sale as completed.</p>
  <script>
    // Function to mark a sale as completed
    function markCompleted(id) {
      const saleRef = ref(db, "pendingSales/" + id);
      update(saleRef, { status: "completed", manuallyClosed: true });
      alert("Marked as completed");
    }
  </script>
</div>


<div class="admin-card">
  <h3>üìú Stakes</h3>
  <table>
    <thead>
      <tr>
        <th>Wallet</th>
        <th>Amount</th>
        <th>Days</th>
        <th>Reward</th>
        <th>Created</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody id="stakeTableBody">
      <!-- Stakes go here -->
      <tr>
        <td colspan="6">‚è≥ Loading...</td>
      </tr>
    </tbody>
  </table>
</div>


 

  <!-- üîó Referral Rewards -->
  <div class="admin-card">
    <h3>üîó Referral Reward Percent</h3>
    <p>Referral Reward Percentage: <span id="referralRewardPercent">5%</span></p>
    <p>Referral Reward Total: <span id="totalReferralReward">0 TRX</span></p>
    <p>Claimed Referral Rewards: <span id="claimedReferralReward">0 TRX</span></p>
    <p>Pending Referral Rewards: <span id="pendingReferralReward">0 TRX</span></p>
    <table>
      <thead><tr><th>Referrer</th><th>Reward</th><th>Status</th></tr></thead>
      <tbody id="referralTableBody">
        <tr><td colspan="3">‚è≥ Loading...</td></tr>
      </tbody>
    </table>
  </div>

  <!-- üéÅ Referral Reward Manual Approval -->
  <div class="admin-card">
    <h3>üéÅ Pending Referral Rewards</h3>
    <table id="pendingReferralTable">
      <thead>
        <tr><th>From</th><th>To</th><th>Amount</th><th>Reward</th><th>Action</th></tr>
      </thead>
      <tbody id="pendingReferralBody">
        <tr><td colspan="5">Loading...</td></tr>
      </tbody>
    </table>
  </div>


  
  <div class="admin-card">
  <!-- ‚úÖ Referral Reward Manual Approval Section -->
<h3>Manual Referral Rewards Approval</h3>
<table border="1" id="pendingReferralTable">
  <thead>
    <tr>
      <th>From</th>
      <th>To</th>
      <th>Stake Amount</th>
      <th>Reward Amount</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody id="pendingReferralBody">
    <tr><td colspan="5">Loading...</td></tr>
  </tbody>
</table>

<!-- ‚úÖ TRX Withdraw Summary Section -->
<h3>TRX Withdraw Summary</h3>
<table border="1" id="withdrawTable">
  <thead>
    <tr>
      <th>Wallet</th>
      <th>Amount</th>
      <th>Date</th>
      <th>Status</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <tr><td colspan="5">Loading...</td></tr>
  </tbody>
</table>
</div>
</div>


  





</body>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getDatabase, ref, onValue, update } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAvyCHq4NDM4zh2IFhm-NczTNy_WJNxv7w",
    authDomain: "veddev-design.firebaseapp.com",
    databaseURL: "https://veddev-design-default-rtdb.firebaseio.com/",
    projectId: "veddev-design",
    storageBucket: "veddev-design.appspot.com",
    messagingSenderId: "1005840455508",
    appId: "1:1005840455508:web:944c6890fbf82167e55ac1"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);






  // üî• Load Sales
  const salesTable = document.getElementById("salesTableBody");
  const refSales = ref(db, "pendingSales");

  onValue(refSales, (snapshot) => {
    salesTable.innerHTML = "";
    const data = snapshot.val();
    for (const id in data) {
      const sale = data[id];
      const row = document.createElement("tr");
      row.innerHTML =
        `<td>${id}</td>
         <td>${sale.saleType}</td>
         <td>${sale.wallet}</td>
         <td>${sale.amount}</td>
         <td>${sale.trxPaid}</td>
         <td>${sale.status}</td>
         <td><button onclick="markCompleted('${id}')">‚úîÔ∏è Complete</button></td>`;
      salesTable.appendChild(row);
    }
  });

  window.markCompleted = (id) => {
    const saleRef = ref(db, "pendingSales/" + id);
    update(saleRef, { status: "completed", manuallyClosed: true });
    alert("Marked as completed");
  };

  // üì¶ Load Stakes
  const stakeTable = document.getElementById("stakeTableBody");
  const refStakes = ref(db, "stakes");

  onValue(refStakes, (snapshot) => {
    stakeTable.innerHTML = "";
    const data = snapshot.val();
    if (!data) return;
    Object.values(data).forEach(stake => {
      const tr = document.createElement("tr");
      const created = new Date(stake.createdAt).toLocaleString();
      tr.innerHTML = `
        <td>${stake.wallet}</td>
        <td>${stake.amount} TRX</td>
        <td>${stake.days}</td>
        <td>${stake.reward} TRX</td>
        <td>${created}</td>
        <td>${stake.claimed ? "‚úÖ Claimed" : "‚è≥ Pending"}</td>`;
      stakeTable.appendChild(tr);
    });
  });
// üî• Sales Table
onValue(refSales, (snapshot) => {
  salesTable.innerHTML = "";
  const data = snapshot.val();
  for (const id in data) {
    const sale = data[id];
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${id}</td>
      <td>${sale.saleType}</td>
      <td>${sale.wallet}</td>
      <td>${sale.amount}</td>
      <td>${sale.trxPaid}</td>
      <td>${sale.status}</td>
      <td><button onclick="markCompleted('${id}')">‚úîÔ∏è Complete</button></td>`;
    salesTable.appendChild(row);
  }
});

// üìä Stake Table & Rewards
onValue(refStakes, (snapshot) => {
  stakeTable.innerHTML = "";
  const data = snapshot.val();
  if (!data) return;

  let totalReward = 0;
  let claimedReward = 0;
  let pendingReward = 0;

  Object.values(data).forEach(stake => {
    const tr = document.createElement("tr");
    const created = new Date(stake.createdAt).toLocaleString();
    tr.innerHTML = `
      <td>${stake.wallet}</td>
      <td>${stake.amount} TRX</td>
      <td>${stake.days}</td>
      <td>${stake.reward} TRX</td>
      <td>${created}</td>
      <td>${stake.claimed ? "‚úÖ Claimed" : "‚è≥ Pending"}</td>`;
    stakeTable.appendChild(tr);

    totalReward += parseFloat(stake.reward || 0);
    if (stake.claimed) {
      claimedReward += parseFloat(stake.reward || 0);
    } else {
      pendingReward += parseFloat(stake.reward || 0);
    }
  });

  document.getElementById("totalStakeReward").textContent = totalReward.toFixed(2) + " TRX";
  document.getElementById("claimedStakeReward").textContent = claimedReward.toFixed(2) + " TRX";
  document.getElementById("pendingStakeReward").textContent = pendingReward.toFixed(2) + " TRX";
});

// üí∞ Referral Rewards
const referralTable = document.getElementById("referralTableBody");
const refReferrals = ref(db, "referralRewards");
onValue(refReferrals, (snapshot) => {
  referralTable.innerHTML = "";
  const data = snapshot.val();
  if (!data) return;

  let totalReferral = 0;

  Object.values(data).forEach(reward => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${reward.referrer}</td>
      <td>${reward.reward} TRX</td>
      <td>${reward.claimed ? "‚úÖ Claimed" : "‚è≥ Pending"}</td>`;
    referralTable.appendChild(tr);

    totalReferral += parseFloat(reward.reward || 0);
  });
  
  });
// üí∏ TRX Withdraw Summary
const trxWithdrawSummary = document.getElementById("trxWithdrawSummary");
const totalWithdraw = document.getElementById("totalWithdraw");
const stakeWithdraw = document.getElementById("stakeWithdraw");
const referralWithdraw = document.getElementById("referralWithdraw");
onValue(ref(db, "withdraws"), (snapshot) => {
  const data = snapshot.val() || {};
  let total = 0;
  let stakeTotal = 0;
  let referralTotal = 0;

  for (const id in data) {
    const withdraw = data[id];
    total += parseFloat(withdraw.amount || 0);
    if (withdraw.type === "stake") {
      stakeTotal += parseFloat(withdraw.amount || 0);
    } else if (withdraw.type === "referral") {
      referralTotal += parseFloat(withdraw.amount || 0);
    }
  }

  totalWithdraw.textContent = total.toFixed(2);
  stakeWithdraw.textContent = stakeTotal.toFixed(2);
  referralWithdraw.textContent = referralTotal.toFixed(2);
});

// üîç Search Wallet Data
function searchWalletData() {
  const wallet = document.getElementById("searchWallet").value.trim();
  if (!wallet) {
    alert("Please enter a wallet address");
    return;
  }

  const searchResult = document.getElementById("searchResult");
  searchResult.innerHTML = "‚è≥ Searching...";

  onValue(ref(db, "stakes"), (snapshot) => {
    const data = snapshot.val();
    if (!data) {
      searchResult.innerHTML = "No stakes found";
      return;
    }

    let found = false;
    for (const id in data) {
      const stake = data[id];
      if (stake.wallet === wallet) {
        found = true;
        searchResult.innerHTML = `
          <h3>Stake Found</h3>
          <p>Wallet: ${stake.wallet}</p>
          <p>Amount: ${stake.amount} TRX</p>
          <p>Days: ${stake.days}</p>
          <p>Reward: ${stake.reward} TRX</p>
          <p>Status: ${stake.claimed ? "‚úÖ Claimed" : "‚è≥ Pending"}</p>`;
        break;
      }
    }

    if (!found) {
      searchResult.innerHTML = "No stakes found for this wallet";
    }
  });
}
  </script>
  <script>
    // üî• Load Total Referral Rewards
    onValue(ref(db, "referralRewards"), (snapshot) => {
      let total = 0;
      snapshot.forEach(childSnapshot => {
        const reward = childSnapshot.val();
        total += parseFloat(reward.reward || 0);
      });
      document.getElementById("totalReferralReward").textContent = total.toFixed(2) + " TRX";
    });

    // üî• Load Claimed and Pending Referral Rewards
    onValue(ref(db, "referralRewards"), (snapshot) => {
      let claimed = 0;
      let pending = 0;
      snapshot.forEach(childSnapshot => {
        const reward = childSnapshot.val();
        if (reward.claimed) {
          claimed += parseFloat(reward.reward || 0);
        } else {
          pending += parseFloat(reward.reward || 0);
        }
      });
      document.getElementById("claimedReferralReward").textContent = claimed.toFixed(2) + " TRX";
      document.getElementById("pendingReferralReward").textContent = pending.toFixed(2) + " TRX";
    });
  </script>

<script type="module" src="app.js"></script>

</html>
