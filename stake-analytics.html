<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stake Analytics</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>
<body>
  <div class="navbar">
    <h1>VedWeb3 Stake Analytics</h1>
  </div>
    
   

<div class="navbar">
  <div id="nav-buttons" style="text-align: center; margin-top: 10px;">
    <a href="index.html" class="nav-btn">ğŸ  Home</a>
    <a href="stake.html" class="nav-btn">ğŸ“¥ Stake</a>
    <a href="history.html" class="nav-btn">ğŸ“œ History</a>
    <a href="stake-analytics.html" class="nav-btn">ğŸ“Š Analytics</a>
  </div>

  <h2>ğŸ“Š Stake Analytics</h2>
 <!-- Chart.js Container -->
  <div class="content">
    <canvas id="analyticsChart" width="auto" height="auto"></canvas>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    function toggleSidebar() {
      document.getElementById("sidebar").classList.toggle("active");
    }

    const ctx = document.getElementById('analyticsChart').getContext('2d');
    const analyticsChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May'],
        datasets: [{
          label: 'Total Staked (TRX)',
          data: [1200, 1900, 3000, 500, 2200],
          backgroundColor: '#0ff',
          borderColor: '#0ff',
          borderWidth: 1
        }]
      },
      options: {
        scales: {
          y: {
            beginAtZero: true,
            ticks: {
              color: '#fff'
            }
          },
          x: {
            ticks: {
              color: '#fff'
            }
          }
        },
        plugins: {
          legend: {
            labels: {
              color: '#fff'
            }
          }
        }
      }
    });
  </script>

  <!-- stakeChart -->
<div style=" width: auto; height: auto; margin: auto; padding-top: 40px;">
    <canvas id="stakeChart"></canvas>
  </div>
  
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getDatabase, ref, get, child } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";
  
    const firebaseConfig = {
  apiKey: "AIzaSyAvyCHq4NDM4zh2IFhm-NczTNy_WJNxv7w",
  authDomain: "veddev-design.firebaseapp.com",
  databaseURL: "https://veddev-design-default-rtdb.firebaseio.com/",
  projectId: "veddev-design",
  storageBucket: "veddev-design.appspot.com",
  messagingSenderId: "1005840455508",
  appId: "1:1005840455508:web:944c6890fbf82167e55ac1",
  measurementId: "G-JVCYDNDW7L"
};
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
  
    // Load stake data and draw chart
    async function drawStakeChart() {
      const snapshot = await get(child(ref(db), "stakes"));
      if (snapshot.exists()) {
        const data = snapshot.val();
        const labels = [];
        const amounts = [];
  
        Object.values(data).forEach(stake => {
          const date = new Date(stake.createdAt).toLocaleDateString();
          const index = labels.indexOf(date);
          if (index !== -1) {
            amounts[index] += stake.amount;
          } else {
            labels.push(date);
            amounts.push(stake.amount);
          }
        });
  
        const ctx = document.getElementById("stakeChart").getContext("2d");
        new Chart(ctx, {
          type: "bar",
          data: {
            labels,
            datasets: [{
              label: "Staked TRX per Day",
              data: amounts,
              backgroundColor: "#00ffaa88"
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { display: false },
              title: {
                display: true,
                text: "ğŸ“ˆ TRX Staking History"
              }
            }
          }
        });
      }
    }
  
    drawStakeChart();
  </script>

  <!-- ğŸ“¢ Referral Overview Card -->
<div class="analytics-card" style="margin-top: 20px;">
  <h3>ğŸ Referral Overview</h3>
  <p><strong>Total Referral Reward:</strong> <span id="referralTotal">0 TRX</span></p>
  <p><strong>Claimed:</strong> <span id="referralClaimed">0 TRX</span></p>
  <p><strong>Pending:</strong> <span id="referralPending">0 TRX</span></p>
  <p><strong>Total Referrals:</strong> <span id="referralCount">0</span></p>
</div>
  
  <!-- ğŸ“Š Referral Reward Distribution Chart -->
<div class="analytics-card" style="margin-top: 20px;">
  <h3>ğŸ“Š Referral Reward Distribution</h3>
  <canvas id="referralChart" height="300"></canvas>
</div>

  <script>
    async function drawReferralChart() {
      const snapshot = await get(child(ref(db), "referrals"));
      if (snapshot.exists()) {
        const data = snapshot.val();
        const labels = [];
        const amounts = [];
  
        Object.values(data).forEach(referral => {
          labels.push(referral.referrer);
          amounts.push(referral.reward);
        });
  
        const ctx = document.getElementById("referralChart").getContext("2d");
        new Chart(ctx, {
          type: "pie",
          data: {
            labels,
            datasets: [{
              label: "Referral Rewards",
              data: amounts,
              backgroundColor: ["#ff6384", "#36a2eb", "#cc65fe", "#ffce56"]
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { position: "top" },
              title: { display: true, text: "ğŸ“Š Referral Rewards Distribution" }
            }
          }
        });
      }
    }
  
    drawReferralChart();
  </script>

  <!-- ğŸ“ˆ Stake Growth Over Time Chart -->
<div class="analytics-card" style="margin-top: 30px;">
  <h3>ğŸ“ˆ Stake Growth Over Time</h3>
  <canvas id="stakeGrowthChart" height="300"></canvas>
</div>
  <script>
    async function drawStakeGrowthChart() {
      const snapshot = await get(child(ref(db), "stakes"));
      if (snapshot.exists()) {
        const data = snapshot.val();
        const labels = [];
        const amounts = [];
  
        Object.values(data).forEach(stake => {
          const date = new Date(stake.createdAt).toLocaleDateString();
          const index = labels.indexOf(date);
          if (index !== -1) {
            amounts[index] += stake.amount;
          } else {
            labels.push(date);
            amounts.push(stake.amount);
          }
        });
  
        const ctx = document.getElementById("stakeGrowthChart").getContext("2d");
        new Chart(ctx, {
          type: "line",
          data: {
            labels,
            datasets: [{
              label: "Total Staked TRX",
              data: amounts,
              borderColor: "#00ffaa",
              backgroundColor: "#00ffaa88",
              fill: true
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { display: false },
              title: { display: true, text: "ğŸ“ˆ Stake Growth Over Time" }
            }
          }
        });
      }
    }
  
    drawStakeGrowthChart();
  </script>





<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</div>

  <div class="footer">
    <p>Â© 2023 VedWeb3. All rights reserved.</p>
  </div>
</body>
</html>
